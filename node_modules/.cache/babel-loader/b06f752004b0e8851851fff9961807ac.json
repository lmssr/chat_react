{"ast":null,"code":"'use strict';\n\nconst decompressResponse = require('decompress-response');\n\nconst is = require('@sindresorhus/is');\n\nconst mimicResponse = require('mimic-response');\n\nconst progress = require('./progress');\n\nmodule.exports = (response, options, emitter) => {\n  const downloadBodySize = Number(response.headers['content-length']) || null;\n  const progressStream = progress.download(response, emitter, downloadBodySize);\n  mimicResponse(response, progressStream);\n  const newResponse = options.decompress === true && is.function(decompressResponse) && options.method !== 'HEAD' ? decompressResponse(progressStream) : progressStream;\n\n  if (!options.decompress && ['gzip', 'deflate'].includes(response.headers['content-encoding'])) {\n    options.encoding = null;\n  }\n\n  emitter.emit('response', newResponse);\n  emitter.emit('downloadProgress', {\n    percent: 0,\n    transferred: 0,\n    total: downloadBodySize\n  });\n  response.pipe(progressStream);\n};","map":null,"metadata":{},"sourceType":"script"}